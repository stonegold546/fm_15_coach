table cellpadding='10'
  tr
    - if result
      td
        - result.each do |x, y|
          - y == 1 ? s = '' : s = 's'
          p
            b #{x}: 
            star class='star'
              | #{y}
            |  star#{s}
    - unless val.length == 2
      td
        - JSON.parse(val).each do |x, y|
          markdown: #{x.capitalize}: #{y}
        input type='button' value='Reuse values' onclick="copyFunction()"
    td
      form action='/' method= 'get'
        table cellpadding='3'
          - inputs = { 'Attacking' => 'attacking', 'Defending' => 'defending',
                       'Fitness' => 'fitness', 'Goalkeepers' => 'goalkeepers',
                       'Mental' => 'mental', 'Tactical' => 'tactical',
                       'Technical' => 'technical',
                       'Determination' => 'determination',
                       'Level of Discipline' => 'discipline',
                       'Motivating' => 'motivating' }
          - inputs.each do |x, y|
            tr
              td
                | #{x}: 
                - if ['determination', 'motivating', 'discipline'].include? y
                  input type='number' class='data' name="#{y}" min='1' max='20' value='1' required='true'
                - else
                  input type='number' class='data' name="#{y}" min='1' max='20' value='1'
        div align='center'
          table
            tr
              td
                input type='submit' value='Submit'
              td
                input type='button' value='Clear' onclick="clearFunction()"

- if result
  javascript:
    function clearFunction() {
      var inputs = document.getElementsByClassName('data');
      for (idx = 0; idx < inputs.length; ++idx) {
        inputs[idx].value = '1';
      }
    }

    function copyFunction() {
      var val = JSON.parse("#{val}".replace(/&quot;/g,'"'));
      var inputs = document.getElementsByClassName('data');
      for (idx = 0; idx < inputs.length; ++idx) {
        inputs[idx].value = val[inputs[idx].name];
      }
    }

    var inputs = document.getElementsByClassName('data');
    for (idx = 0; idx < inputs.length; ++idx) {
      var input = inputs[idx];
      input.addEventListener('input', function() {
        var myResult = new XMLHttpRequest();
        var url = '/?api=y'.concat(
          '&attacking=', inputs[0].value, '&defending=', inputs[1].value,
          '&fitness=', inputs[2].value, '&goalkeepers=', inputs[3].value,
          '&mental=', inputs[4].value, '&tactical=', inputs[5].value,
          '&technical=', inputs[6].value, '&determination=', inputs[7].value,
          '&discipline=', inputs[8].value, '&motivating=', inputs[9].value
        );
        myResult.open('GET', url, true);
        myResult.send();
        myResult.onreadystatechange = function() {
          var stars = document.getElementsByClassName('star');
          var data = JSON.parse(myResult.responseText);
          console.log(data);
          var inner_idx = 0;
          for (var i in data) {
            stars[inner_idx].innerHTML = data[i];
            inner_idx++;
          }
        }
      });
    }
